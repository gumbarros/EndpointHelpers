@model List<Order>
@inject LinkGenerator Links

@{
    ViewData["Title"] = "Orders";
    var status = (string)(ViewData["Status"] ?? "");
    var customer = (string)(ViewData["Customer"] ?? "");
    var q = (string)(ViewData["Query"] ?? "");
    var recentDays = ViewData["RecentDays"]?.ToString();
}

<div class="d-flex justify-content-between align-items-center">
    <div>
        <h1>Orders</h1>
        @if (!string.IsNullOrWhiteSpace(recentDays))
        {
            <div class="text-muted">Recent orders (last @recentDays days)</div>
        }
    </div>
    <div>
        <a class="btn btn-primary" href="@Url.Orders.Create()">Create order</a>
    </div>
</div>

<div class="mt-3">
    <form method="get" action="@Url.Orders.Index()">
        <div class="row g-2">
            <div class="col-md-3">
                <input class="form-control" type="text" name="q" value="@q" placeholder="Search id, customer, status"/>
            </div>
            <div class="col-md-3">
                <input class="form-control" type="text" name="status" value="@status" placeholder="Status"/>
            </div>
            <div class="col-md-3">
                <input class="form-control" type="text" name="customer" value="@customer" placeholder="Customer"/>
            </div>
            <div class="col-md-3 d-flex gap-2">
                <button class="btn btn-outline-secondary" type="submit">Filter</button>
                <a class="btn btn-outline-secondary" href="@Url.Orders.Index()">Reset</a>
            </div>
        </div>
    </form>
</div>

<div class="mt-4">
    <div class="d-flex flex-wrap gap-2">
        <a class="btn btn-sm btn-outline-primary" href="@Url.Orders.Recent(3)">Recent 3 days</a>
        <a class="btn btn-sm btn-outline-primary" href="@Url.Orders.Recent(7)">Recent 7 days</a>
        <a class="btn btn-sm btn-outline-primary" href='@Url.Orders.ByStatus("Open")'>Open</a>
        <a class="btn btn-sm btn-outline-primary" href='@Url.Orders.ByStatus("Processing")'>Processing</a>
        <a class="btn btn-sm btn-outline-primary" href='@Url.Orders.ByStatus("Shipped")'>Shipped</a>
        <a class="btn btn-sm btn-outline-primary" href='@Url.Orders.ByCustomer("Northwind")'>Northwind</a>
        <a class="btn btn-sm btn-outline-primary" href='@Url.Orders.ByCustomer("Contoso")'>Contoso</a>
        <a class="btn btn-sm btn-outline-primary" href='@Url.Orders.Export("csv")'>Export CSV</a>
        <a class="btn btn-sm btn-outline-primary" href='@Url.Orders.Export("json")'>Export JSON</a>
    </div>
</div>

<div class="mt-4">
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Id</th>
            <th>Customer</th>
            <th>Status</th>
            <th>Total</th>
            <th>Created</th>
            <th>Links</th>
        </tr>
        </thead>
        <tbody>
        @foreach (var order in Model)
        {
            <tr>
                <td>@order.Id</td>
                <td>@order.Customer</td>
                <td>@order.Status</td>
                <td>@order.Total.ToString("C")</td>
                <td>@order.CreatedUtc.ToString("u")</td>
                <td class="d-flex flex-wrap gap-2">
                    <a class="btn btn-sm btn-outline-secondary" href='@Url.Orders.Details(order.Id, "index")'>Details</a>
                    <a class="btn btn-sm btn-outline-secondary" href="@Url.Orders.Edit(order.Id)">Edit</a>
                    <a class="btn btn-sm btn-outline-danger" href="@Url.Orders.Delete(order.Id)">Delete</a>
                    <a class="btn btn-sm btn-outline-secondary" href="@Url.Orders.Clone(order.Id)">Clone</a>
                    <a class="btn btn-sm btn-outline-secondary" href='@Links.Orders.GetDetailsPath(order.Id, "linkgen")'>LinkGenerator</a>
                    <a class="btn btn-sm btn-outline-secondary" href='@Links.Orders.GetDetailsPath(Context, order.Id, "http-context")'>LinkGenerator + HttpContext</a>
                </td>
            </tr>
        }
        </tbody>
    </table>
</div>
